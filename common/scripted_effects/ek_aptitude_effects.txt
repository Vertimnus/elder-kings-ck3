# add_aptitude_skill = { VALUE = x }
# add_aptitude_skill = {
#     if = {
#         limit = { NOT = { exists = var:aptitude_base } }
#         #limit = { NOT = { has_variable = aptitude_base } }
#         set_variable = { name = aptitude_base value = 0 }
#     }
#     custom_description = {
#         text = add_aptitude_skill
#         value = $VALUE$
#         change_variable = { name = aptitude_base add = $VALUE$ }
#     }
#     if = {
#         limit = { var:aptitude_base < 0 }
#         set_variable = { name = aptitude_base value = 0 }
#     }
# }
add_aptitude_skill = {
    custom_description = {
        text = add_aptitude_skill
        value = $VALUE$
        if = {
            #limit = { NOT = { exists = var:aptitude_base } }
            limit = { NOT = { has_variable = aptitude_base } }
            set_variable = { name = aptitude_base value = $VALUE$ }
            if = { #this is nested to stop the error log having an aneurism if the variable doesn't exist
                limit = { $VALUE$ < 0 }
                set_variable = { name = aptitude_base value = 0 }
            }
        }
        else = {
            change_variable = { name = aptitude_base add = $VALUE$ }
            if = {
                limit = { var:aptitude_base < 0 }
                set_variable = { name = aptitude_base value = 0 }
            }
        }
    }
}
# add_magicka = {
#     if = {
#         limit = { NOT = { exists = var:magicka } }
#         #limit = { NOT = { has_variable = magicka } }
#         set_variable = { name = magicka value = 0 }
#     }
#     custom_description = {
#         text = add_magicka
#         value = $VALUE$
#         change_variable = { name = magicka add = $VALUE$ }
#     }
#     if = {
#         limit = { var:magicka > magicka_max }
#         set_variable = { name = magicka value = magicka_max }
#     }
# }
add_magicka = {
    custom_description = {
        text = add_magicka
        value = $VALUE$
        if = {
            #limit = { NOT = { exists = var:magicka } }
            limit = { NOT = { has_variable = magicka } }
            set_variable = { name = magicka value = $VALUE$ }
            if = {
                limit = { $VALUE$ > magicka_max }
                set_variable = { name = magicka value = magicka_max }
            }
        }
        else = {
            change_variable = { name = magicka add = $VALUE$ }
            if = {
                limit = { var:magicka > magicka_max }
                set_variable = { name = magicka value = magicka_max }
            }
        }
    }
}
add_quarterly_magicka_effect = {
    trigger_event = {
        on_action = add_monthly_magicka
        #days = 0
    }
    trigger_event = {
        on_action = add_monthly_magicka
        months = 1
    }
    trigger_event = {
        on_action = add_monthly_magicka
        months = 2
    }
}
add_monthly_magicka_effect = {
    add_magicka = { VALUE = magicka_monthly }
}

spell_caster_effect = {
    if = { #actual effect here
        limit = { has_variable = spell_cast_enabled }
        #add_magicka = { VALUE = -10 }
        #add_magicka = { VALUE = spell_$SPELL$_cost }
        spell_$SPELL$_caster_effect = yes
    }
    else = {
        hidden_effect = { #move to recipient and have is_valid and execute check for not variable clear on cast
            set_variable = { name = spell_selected value = flag:$SPELL$ }
        }
        if = {
            limit = { $HOSTILE$ = yes }
            custom_label = spell_name_caster_hostile
        }
        else = {
            custom_label = spell_name_caster
        }
        show_as_tooltip = { #effect here is for tooltip
            #add_magicka = { VALUE = -10 }
            spell_$SPELL$_caster_effect = yes
        }
    }
}
spell_castee_effect = {
    if = {
        limit = { $HOSTILE$ = yes }
        custom_label = spell_name_castee_hostile
    }
    else = {
        custom_label = spell_name_castee
    }
    #add_aptitude_skill = { VALUE = 1 }
    spell_$SPELL$_castee_effect = yes
}

spell_flames_caster_effect = {
    add_magicka = { VALUE = neg_spell_cost_flames }
}
spell_flames_castee_effect = {
    add_aptitude_skill = { VALUE = 1 }
}
spell_frostbite_caster_effect = {
    add_magicka = { VALUE = neg_spell_cost_frostbite }
}
spell_frostbite_castee_effect = {
    add_aptitude_skill = { VALUE = 2 }
}
spell_sparks_caster_effect = {
    add_magicka = { VALUE = neg_spell_cost_sparks }
}
spell_sparks_castee_effect = {
    add_aptitude_skill = { VALUE = 3 }
}

init_destruction = {
    add_to_variable_list = { name = spell_list_destruction target = title:b_adamantine.title_province }
    add_to_variable_list = { name = spell_list_destruction target = title:b_balfiera.title_province }
    add_to_variable_list = { name = spell_list_destruction target = title:b_gallomarket.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_medora.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_mynisera.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_grimfield.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_stonetooth.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_morisel.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_little_betony.title_province }
    # add_to_variable_list = { name = spell_list_destruction target = title:b_glenpoint.title_province }
}