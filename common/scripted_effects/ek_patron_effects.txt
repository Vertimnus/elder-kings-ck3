patron_clear_variables = {
    # Daedra #
    remove_variable = patron_azura_shown
    remove_variable = patron_boethiah_shown
    remove_variable = patron_clavicus_shown
    remove_variable = patron_hermaeus_shown
    remove_variable = patron_hircine_shown
    remove_variable = patron_jyggalag_shown
    remove_variable = patron_malacath_shown
    remove_variable = patron_mehrunes_shown
    remove_variable = patron_mephala_shown
    remove_variable = patron_meridia_shown
    remove_variable = patron_molag_shown
    remove_variable = patron_namira_shown
    remove_variable = patron_nocturnal_shown
    remove_variable = patron_peryite_shown
    remove_variable = patron_sanguine_shown
    remove_variable = patron_sheogorath_shown
    remove_variable = patron_vaermina_shown

    # Tribunal #
    remove_variable = patron_almalexia_shown
    remove_variable = patron_sotha_sil_shown
    remove_variable = patron_vivec_shown

    # Pantheons #
    remove_variable = patron_divines_shown
    remove_variable = patron_aldmer_shown
    remove_variable = patron_dwemer_ancestors_shown

    # Tabs # these are here to force close the interaction tab on faith change
    remove_variable = patron_interaction_tab_toggle
    remove_variable = patron_interaction_passive_tab_toggle
}

patron_clear_res_variables = {
    # Daedra #
    remove_variable = patron_azura_shown_res
    remove_variable = patron_boethiah_shown_res
    remove_variable = patron_clavicus_shown_res
    remove_variable = patron_hermaeus_shown_res
    remove_variable = patron_hircine_shown_res
    remove_variable = patron_jyggalag_shown_res
    remove_variable = patron_malacath_shown_res
    remove_variable = patron_mehrunes_shown_res
    remove_variable = patron_mephala_shown_res
    remove_variable = patron_meridia_shown_res
    remove_variable = patron_molag_shown_res
    remove_variable = patron_namira_shown_res
    remove_variable = patron_nocturnal_shown_res
    remove_variable = patron_peryite_shown_res
    remove_variable = patron_sanguine_shown_res
    remove_variable = patron_sheogorath_shown_res
    remove_variable = patron_vaermina_shown_res

    # Tribunal #
    remove_variable = patron_almalexia_shown_res
    remove_variable = patron_sotha_sil_shown_res
    remove_variable = patron_vivec_shown_res

    # Pantheons #
    ## Nedic-Nordic
    remove_variable = patron_divines_shown_res
    ## Aldmeri
    remove_variable = patron_aldmer_shown_res
    ## Reach
    remove_variable = patron_dwemer_ancestors_shown_res


    # Tabs # these are here to force close the interaction tab on faith change
    remove_variable = patron_interaction_tab_toggle_res
    remove_variable = patron_interaction_passive_tab_toggle_res
}

patron_passive_clear_variables = {
    # Divines #
    remove_variable = patron_akatosh_shown
    remove_variable = patron_arkay_shown
    remove_variable = patron_dibella_shown
    remove_variable = patron_julianos_shown
    remove_variable = patron_kynareth_shown
    remove_variable = patron_mara_shown
    remove_variable = patron_stendarr_shown
    remove_variable = patron_talos_shown
    remove_variable = patron_zenithar_shown
    remove_variable = patron_shezarr_shown
    # Aldmer #
    remove_variable = patron_auriel_shown
    remove_variable = patron_jephre_shown
    remove_variable = patron_magnus_shown
    remove_variable = patron_phynaster_shown
    remove_variable = patron_syrabane_shown
    remove_variable = patron_trinimac_shown
    remove_variable = patron_xarxes_shown
    remove_variable = patron_xen_shown
    # Dwemer Ancestors
    remove_variable = patron_da_architect_shown
    remove_variable = patron_da_warrior_shown
    remove_variable = patron_da_giant_shown
    remove_variable = patron_da_lost_king_shown
}

patron_clear_traits = {
    remove_trait = p_akatosh
    remove_trait = p_arkay
    remove_trait = p_dibella
    remove_trait = p_julianos
    remove_trait = p_kynareth
    remove_trait = p_mara
    remove_trait = p_stendarr
    remove_trait = p_zenithar
    remove_trait = p_shezarr
    remove_trait = p_auriel
    remove_trait = p_jephre
    remove_trait = p_magnus
    remove_trait = p_phynaster
    remove_trait = p_syrabane
    remove_trait = p_trinimac
    remove_trait = p_xarxes
    remove_trait = p_xen
    # Dwemer Ancestors
    remove_trait = p_da_architect
    remove_trait = p_da_warrior
    remove_trait = p_da_giant
    remove_trait = p_da_lost_king
}

patron_assign_trait = {
    # Divines #
    if = {
        limit = { has_variable = patron_akatosh_shown }
        add_trait = p_akatosh
    }
    else_if = {
        limit = { has_variable = patron_arkay_shown }
        add_trait = p_arkay
    }
    else_if = {
        limit = { has_variable = patron_dibella_shown }
        add_trait = p_dibella
    }
    else_if = {
        limit = { has_variable = patron_julianos_shown }
        add_trait = p_julianos
    }
    else_if = {
        limit = { has_variable = patron_kynareth_shown }
        add_trait = p_kynareth
    }
    else_if = {
        limit = { has_variable = patron_mara_shown }
        add_trait = p_mara
    }
    else_if = {
        limit = { has_variable = patron_stendarr_shown }
        add_trait = p_stendarr
    }
    else_if = {
        limit = { has_variable = patron_zenithar_shown }
        add_trait = p_zenithar
    }
    else_if = {
        limit = { has_variable = patron_shezarr_shown }
        add_trait = p_shezarr
    }
    # Aldmer #
    else_if = {
        limit = { has_variable = patron_auriel_shown }
        add_trait = p_auriel
    }
    else_if = {
        limit = { has_variable = patron_jephre_shown }
        add_trait = p_jephre
    }
    else_if = {
        limit = { has_variable = patron_magnus_shown }
        add_trait = p_magnus
    }
    else_if = {
        limit = { has_variable = patron_phynaster_shown }
        add_trait = p_phynaster
    }
    else_if = {
        limit = { has_variable = patron_syrabane_shown }
        add_trait = p_syrabane
    }
    else_if = {
        limit = { has_variable = patron_trinimac_shown }
        add_trait = p_trinimac
    }
    else_if = {
        limit = { has_variable = patron_xarxes_shown }
        add_trait = p_xarxes
    }
    else_if = {
        limit = { has_variable = patron_xen_shown }
        add_trait = p_xen
    }
    # Dwemer Ancestors
    else_if = {
        limit = { has_variable = patron_da_architect_shown }
        add_trait = p_da_architect
    }
    else_if = {
        limit = { has_variable = patron_da_warrior_shown }
        add_trait = p_da_warrior
    }
    else_if = {
        limit = { has_variable = patron_da_giant_shown }
        add_trait = p_da_giant
    }
    else_if = {
        limit = { has_variable = patron_da_lost_king_shown }
        add_trait = p_da_lost_king
    }

    add_character_flag = { flag = recent_patron_selected years = 5 }
}

#this one only clears if the patron is no longer valid so nord cult -> imperial cult keeps akatosh
patron_faith_change_clear_traits = {
    # Divines #
    if = {
        limit = { patron_akatosh_valid = no }
        remove_trait = p_akatosh
    }
    else_if = {
        limit = { patron_arkay_valid = no }
        remove_trait = p_arkay
    }
    else_if = {
        limit = { patron_dibella_valid = no }
        remove_trait = p_dibella
    }
    else_if = {
        limit = { patron_julianos_valid = no }
        remove_trait = p_julianos
    }
    else_if = {
        limit = { patron_kynareth_valid = no }
        remove_trait = p_kynareth
    }
    else_if = {
        limit = { patron_mara_valid = no }
        remove_trait = p_mara
    }
    else_if = {
        limit = { patron_stendarr_valid = no }
        remove_trait = p_stendarr
    }
    else_if = {
        limit = { patron_zenithar_valid = no }
        remove_trait = p_zenithar
    }
    else_if = {
        limit = { patron_shezarr_valid = no }
        remove_trait = p_shezarr
    }
    # Aldmer #
    else_if = {
        limit = { patron_auriel_valid = no }
        remove_trait = p_auriel
    }
    else_if = {
        limit = { patron_jephre_valid = no }
        remove_trait = p_jephre
    }
    else_if = {
        limit = { patron_magnus_valid = no }
        remove_trait = p_magnus
    }
    else_if = {
        limit = { patron_phynaster_valid = no }
        remove_trait = p_phynaster
    }
    else_if = {
        limit = { patron_syrabane_valid = no }
        remove_trait = p_syrabane
    }
    else_if = {
        limit = { patron_trinimac_valid = no }
        remove_trait = p_trinimac
    }
    else_if = {
        limit = { patron_xarxes_valid = no }
        remove_trait = p_xarxes
    }
    else_if = {
        limit = { patron_xen_valid = no }
        remove_trait = p_xen
    }
    # Dwemer Ancestors
    else_if = {
        limit = { patron_da_architect_valid = no }
        remove_trait = p_da_architect
    }
    else_if = {
        limit = { patron_da_warrior_valid = no }
        remove_trait = p_da_architect
    }
    else_if = {
        limit = { patron_da_giant_valid = no }
        remove_trait = p_da_architect
    }
    else_if = {
        limit = { patron_da_lost_king_valid = no }
        remove_trait = p_da_architect
    }

    add_character_flag = { flag = recent_patron_selected years = 5 }
}

patron_faith_change_effect = {
    patron_clear_variables = yes
    patron_clear_res_variables = yes
    patron_passive_clear_variables = yes
    patron_faith_change_clear_traits = yes
}

# Ardor System #

# ardor_[patron] is set to zero on startup and faith change for all valid patrons
# ardor_display is used as an intermediry for decision costs and display
# on communing it is assigned to the value of the chosen patron, ardor_[patron] is updated by each decision
# for ai ardor_display is updated on patron choice decision
# initializing for the ai is done by patron choice selection - since they access one at a time only need one variable active

# try using get_patron and $PATRON$ on update effects to streamline
# need to be able to get a return value to make it useful though I think

patron_ardor_initialize = {
    if = {
        limit = {
            patron_azura_valid = yes
            NOT = { has_variable = ardor_azura }
        }
        set_variable = { name = ardor_azura value = 0 }
    }
    if = {
        limit = {
            patron_boethiah_valid = yes
            NOT = { has_variable = ardor_boethiah }
        }
        set_variable = { name = ardor_boethiah value = 0 }
    }
    if = {
        limit = {
            patron_clavicus_valid = yes
            NOT = { has_variable = ardor_clavicus }
        }
        set_variable = { name = ardor_clavicus value = 0 }
    }
    if = {
        limit = {
            patron_hermaeus_valid = yes
            NOT = { has_variable = ardor_hermaeus }
        }
        set_variable = { name = ardor_hermaeus value = 0 }
    }
    if = {
        limit = {
            patron_hircine_valid = yes
            NOT = { has_variable = ardor_hircine }
        }
        set_variable = { name = ardor_hircine value = 0 }
    }
    if = {
        limit = {
            patron_malacath_valid = yes
            NOT = { has_variable = ardor_malacath }
        }
        set_variable = { name = ardor_malacath value = 0 }
    }
    if = {
        limit = {
            patron_mehrunes_valid = yes
            NOT = { has_variable = ardor_mehrunes }
        }
        set_variable = { name = ardor_mehrunes value = 0 }
    }
    if = {
        limit = {
            patron_mephala_valid = yes
            NOT = { has_variable = ardor_mephala }
        }
        set_variable = { name = ardor_mephala value = 0 }
    }
    if = {
        limit = {
            patron_meridia_valid = yes
            NOT = { has_variable = ardor_meridia }
        }
        set_variable = { name = ardor_meridia value = 0 }
    }
    if = {
        limit = {
            patron_molag_valid = yes
            NOT = { has_variable = ardor_molag }
        }
        set_variable = { name = ardor_molag value = 0 }
    }
    if = {
        limit = {
            patron_namira_valid = yes
            NOT = { has_variable = ardor_namira }
        }
        set_variable = { name = ardor_namira value = 0 }
    }
    if = {
        limit = {
            patron_nocturnal_valid = yes
            NOT = { has_variable = ardor_nocturnal }
        }
        set_variable = { name = ardor_nocturnal value = 0 }
    }
    if = {
        limit = {
            patron_peryite_valid = yes
            NOT = { has_variable = ardor_peryite }
        }
        set_variable = { name = ardor_peryite value = 0 }
    }
    if = {
        limit = {
            patron_sanguine_valid = yes
            NOT = { has_variable = ardor_sanguine }
        }
        set_variable = { name = ardor_sanguine value = 0 }
    }
    if = {
        limit = {
            patron_sheogorath_valid = yes
            NOT = { has_variable = ardor_sheogorath }
        }
        set_variable = { name = ardor_sheogorath value = 0 }
    }
    if = {
        limit = {
            patron_vaermina_valid = yes
            NOT = { has_variable = ardor_vaermina }
        }
        set_variable = { name = ardor_vaermina value = 0 }
    }
}

patron_ardor_update_display = {
    if = {
        limit = { has_variable = patron_azura_shown }
        set_variable = { name = ardor_display value = var:ardor_azura }
    }
    else_if = {
        limit = { has_variable = patron_boethiah_shown }
        set_variable = { name = ardor_display value = var:ardor_boethiah }
    }
    else_if = {
        limit = { has_variable = patron_clavicus_shown }
        set_variable = { name = ardor_display value = var:ardor_clavicus }
    }
    else_if = {
        limit = { has_variable = patron_hermaeus_shown }
        set_variable = { name = ardor_display value = var:ardor_hermaeus }
    }
    else_if = {
        limit = { has_variable = patron_hircine_shown }
        set_variable = { name = ardor_display value = var:ardor_hircine }
    }
    else_if = {
        limit = { has_variable = patron_malacath_shown }
        set_variable = { name = ardor_display value = var:ardor_malacath }
    }
    else_if = {
        limit = { has_variable = patron_mehrunes_shown }
        set_variable = { name = ardor_display value = var:ardor_mehrunes }
    }
    else_if = {
        limit = { has_variable = patron_mephala_shown }
        set_variable = { name = ardor_display value = var:ardor_mephala }
    }
    else_if = {
        limit = { has_variable = patron_meridia_shown }
        set_variable = { name = ardor_display value = var:ardor_meridia }
    }
    else_if = {
        limit = { has_variable = patron_molag_shown }
        set_variable = { name = ardor_display value = var:ardor_molag }
    }
    else_if = {
        limit = { has_variable = patron_namira_shown }
        set_variable = { name = ardor_display value = var:ardor_namira }
    }
    else_if = {
        limit = { has_variable = patron_nocturnal_shown }
        set_variable = { name = ardor_display value = var:ardor_nocturnal }
    }
    else_if = {
        limit = { has_variable = patron_peryite_shown }
        set_variable = { name = ardor_display value = var:ardor_peryite }
    }
    else_if = {
        limit = { has_variable = patron_sanguine_shown }
        set_variable = { name = ardor_display value = var:ardor_sanguine }
    }
    else_if = {
        limit = { has_variable = patron_sheogorath_shown }
        set_variable = { name = ardor_display value = var:ardor_sheogorath }
    }
    else_if = {
        limit = { has_variable = patron_vaermina_shown }
        set_variable = { name = ardor_display value = var:ardor_vaermina }
    }
    else = { #this should never fire, in for debugging when it does
        set_variable = { name = ardor_display value = 0 }
        set_variable = ardor_display_error
    }
}

patron_ardor_update_actual = {
    if = {
        limit = { has_variable = patron_azura_shown }
        set_variable = { name = ardor_azura value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_boethiah_shown }
        set_variable = { name = ardor_boethiah value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_clavicus_shown }
        set_variable = { name = ardor_clavicus value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_hermaeus_shown }
        set_variable = { name = ardor_hermaeus value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_hircine_shown }
        set_variable = { name = ardor_hircine value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_malacath_shown }
        set_variable = { name = ardor_malacath value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_mehrunes_shown }
        set_variable = { name = ardor_mehrunes value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_mephala_shown }
        set_variable = { name = ardor_mephala value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_meridia_shown }
        set_variable = { name = ardor_meridia value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_molag_shown }
        set_variable = { name = ardor_molag value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_namira_shown }
        set_variable = { name = ardor_namira value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_nocturnal_shown }
        set_variable = { name = ardor_nocturnal value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_peryite_shown }
        set_variable = { name = ardor_peryite value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_sanguine_shown }
        set_variable = { name = ardor_sanguine value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_sheogorath_shown }
        set_variable = { name = ardor_sheogorath value = var:ardor_display }
    }
    else_if = {
        limit = { has_variable = patron_vaermina_shown }
        set_variable = { name = ardor_vaermina value = var:ardor_display }
    }
}

patron_ardor_change = {
    custom_description = {
        text = patron_ardor_change
        value = $ARDOR$ #doesnt auto detect value
        change_variable = { name = ardor_display add = $ARDOR$ }
    }
    patron_ardor_update_actual = yes
}

patron_status_initialize = {
    set_global_variable = { name = status_azura value = flag:nominal }
    set_global_variable = { name = status_boethiah value = flag:nominal }
    set_global_variable = { name = status_clavicus value = flag:nominal }
    set_global_variable = { name = status_hermaeus value = flag:nominal }
    set_global_variable = { name = status_hircine value = flag:nominal }
    set_global_variable = { name = status_malacath value = flag:nominal }
    set_global_variable = { name = status_mehrunes value = flag:nominal }
    set_global_variable = { name = status_mephala value = flag:nominal }
    set_global_variable = { name = status_meridia value = flag:nominal }
    set_global_variable = { name = status_molag value = flag:nominal }
    set_global_variable = { name = status_namira value = flag:nominal }
    set_global_variable = { name = status_nocturnal value = flag:nominal }
    set_global_variable = { name = status_peryite value = flag:nominal }
    set_global_variable = { name = status_sanguine value = flag:nominal }
    set_global_variable = { name = status_sheogorath value = flag:nominal }
    set_global_variable = { name = status_vaermina value = flag:nominal }
}

patron_trait_master_effect = {
    $EFFECT$ = { TRAIT = _akatosh }
    $EFFECT$ = { TRAIT = _arkay }
    $EFFECT$ = { TRAIT = _dibella }
    $EFFECT$ = { TRAIT = _julianos }
    $EFFECT$ = { TRAIT = _kynareth }
    $EFFECT$ = { TRAIT = _mara }
    $EFFECT$ = { TRAIT = _stendarr }
    $EFFECT$ = { TRAIT = _zenithar }
    $EFFECT$ = { TRAIT = _shezarr }
    $EFFECT$ = { TRAIT = _auriel }
    $EFFECT$ = { TRAIT = _jephre }
    $EFFECT$ = { TRAIT = _magnus }
    $EFFECT$ = { TRAIT = _phynaster }
    $EFFECT$ = { TRAIT = _syrabane }
    $EFFECT$ = { TRAIT = _trinimac }
    $EFFECT$ = { TRAIT = _xarxes }
    $EFFECT$ = { TRAIT = _xen }
    $EFFECT$ = { TRAIT = _azura }
    $EFFECT$ = { TRAIT = _boethiah }
    $EFFECT$ = { TRAIT = _clavicus }
    $EFFECT$ = { TRAIT = _hermaeus }
    $EFFECT$ = { TRAIT = _hircine }
    $EFFECT$ = { TRAIT = _malacath }
    $EFFECT$ = { TRAIT = _mehrunes }
    $EFFECT$ = { TRAIT = _mephala }
    $EFFECT$ = { TRAIT = _meridia }
    $EFFECT$ = { TRAIT = _molag }
    $EFFECT$ = { TRAIT = _namira }
    $EFFECT$ = { TRAIT = _nocturnal }
    $EFFECT$ = { TRAIT = _peryite }
    $EFFECT$ = { TRAIT = _sanguine }
    $EFFECT$ = { TRAIT = _sheogorath }
    $EFFECT$ = { TRAIT = _vaermina }
    $EFFECT$ = { TRAIT = _da_architect }
    $EFFECT$ = { TRAIT = _da_giant }
    $EFFECT$ = { TRAIT = _da_lost_king }
    $EFFECT$ = { TRAIT = _da_warrior }
    $EFFECT$ = { TRAIT = _at_bear }
    $EFFECT$ = { TRAIT = _at_dragon }
    $EFFECT$ = { TRAIT = _at_fox }
    $EFFECT$ = { TRAIT = _at_hawk }
    $EFFECT$ = { TRAIT = _at_moth }
    $EFFECT$ = { TRAIT = _at_owl }
    $EFFECT$ = { TRAIT = _at_snake }
    $EFFECT$ = { TRAIT = _at_whale }
    $EFFECT$ = { TRAIT = _at_wolf }
}

patron_get_list = {
    patron_trait_master_effect = { EFFECT = patron_add_to_list }
}

patron_add_to_list = {
    if = {
        limit = { patron$TRAIT$_valid = yes }
        scope:player_s = { add_to_variable_list = { name = faith_patrons target = flag:$TRAIT$ } }
    }
}

# patron_set_trait = { #need 1.4 commands to pass flag/scope:trait from gui
#     patron_trait_master_effect = { EFFECT = patron_add_trait }
# }

# patron_add_trait = { #need 1.4 commands to pass flag/scope:trait from gui
#     if = {
#         limit = { flag/scope:trait = $TRAIT$ }
#         add_trait = p$TRAIT$
#     }
# }